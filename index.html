<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Elementos Materiais</title>
 <title>Catálogo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        header { background: #556B2F; padding: 10px 20px; color: white; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        header img.logo { height: 100px; margin-bottom: 10px; }
        header h1 { margin: 0; font-size: 28px; text-align: center; }
        nav { background: #6B8E23; padding: 10px; text-align: center; }
        nav a { color: white; margin: 0 15px; text-decoration: none; font-weight: bold; cursor: pointer; }
        .search-bar { padding: 20px; text-align: center; }
        .search-bar input { width: 50%; padding: 10px; font-size: 16px; border: 1px solid #ddd; border-radius: 5px; }
        .filters { text-align: center; margin-bottom: 20px; }
        .filters button { background: #6B8E23; color: white; border: none; padding: 8px 15px; margin: 5px; border-radius: 5px; cursor: pointer; }
        .filters button.active { background: #556B2F; }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .product-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            overflow: hidden; /* Garante que nada transborde do card */
        }
        /* INÍCIO DA ALTERAÇÃO PARA TAMANHO DA IMAGEM */
        .product-card .product-thumbnail {
            max-width: 120px;   /* Largura máxima da imagem */
            height: 120px;      /* Altura fixa para manter a proporção no formato quadrado */
            object-fit: cover;  /* Garante que a imagem preencha a área, cortando o excesso */
            border-radius: 5px;
            margin-bottom: 10px;
            cursor: pointer;
        }
        /* FIM DA ALTERAÇÃO PARA TAMANHO DA IMAGEM */
        .product-card h3 { font-size: 1.1em; margin: 10px 0; min-height: 40px; }
        .product-card p { font-size: 0.9em; color: #555; min-height: 60px; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; }
        .product-card .price { font-size: 1.2em; color: #556B2F; font-weight: bold; margin-bottom: 10px; }
        .product-card button { background: #6B8E23; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; transition: background 0.3s ease; }
        .product-card button:hover { background: #556B2F; }
        .section { padding: 20px; display: none; }
        .section.active { display: block; }
        .admin-panel {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .admin-panel h2 { text-align: center; color: #556B2F; margin-bottom: 20px; }
        .admin-panel label { display: block; margin-bottom: 5px; font-weight: bold; }
        .admin-panel input[type="text"],
        .admin-panel input[type="number"],
        .admin-panel textarea,
        .admin-panel select {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
        }
        .admin-panel textarea { resize: vertical; min-height: 80px; }
        .admin-panel button {
            background: #6B8E23;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: background 0.3s ease;
        }
        .admin-panel button:hover { background: #556B2F; }
        .admin-panel button.delete { background: #dc3545; }
        .admin-panel button.delete:hover { background: #c82333; }
        .product-list-admin { list-style: none; padding: 0; }
        .product-list-admin li {
            background: #f9f9f9;
            border: 1px solid #eee;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .product-list-admin li button { margin-left: 10px; }
        .hidden { display: none; }
        .cart-panel {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .cart-panel h2 { text-align: center; color: #556B2F; margin-bottom: 20px; }
        .cart-items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .cart-items-table th, .cart-items-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .cart-items-table th { background-color: #f2f2f2; }
        .cart-total { text-align: right; font-size: 1.2em; font-weight: bold; margin-top: 10px; }
        .cart-actions { text-align: center; margin-top: 20px; }
        .cart-actions button { background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: background 0.3s ease; }
        .cart-actions button:hover { background: #218838; }
        .cart-actions p { font-size: 0.9em; color: #666; margin-top: 10px; }
        .cart-actions a { color: #007bff; text-decoration: none; }
        .cart-actions a:hover { text-decoration: underline; }
        #observacoes-adicionais {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            resize: vertical;
            min-height: 60px;
        }

        /* Modal para Imagem Ampliada */
        .image-modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.8); /* Black w/ opacity */
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            margin: auto;
            display: block;
            max-width: 90%;
            max-height: 90%;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }

        .close-modal:hover,
        .close-modal:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header>
        <img src="https://catalogo.vercel.app/imagens/Logo.PNG" alt="Elementos Materiais Logo" class="logo">
        <h1>Catálogo de Produtos</h1>
    </header>
    <nav>
        <a onclick="mostrarPainel('produtos')">Produtos</a>
        <a onclick="mostrarPainel('carrinho')">Carrinho</a>
        <a onclick="mostrarPainel('admin')">Admin</a>
    </nav>

    <div class="search-bar">
        <input type="text" id="search-input" placeholder="Buscar produtos...">
    </div>

    <div class="filters" id="category-filters">
        </div>

    <section id="produtos" class="section active">
        <div class="product-grid" id="product-grid">
            </div>
    </section>

    <section id="carrinho" class="section" style="display: none;">
        <div class="cart-panel">
            <h2>Seu Carrinho</h2>
            <p>Observações adicionais:</p>
            <textarea id="observacoes-adicionais" placeholder="Adicione observações ao seu pedido aqui..."></textarea>
            <table class="cart-items-table">
                <thead>
                    <tr>
                        <th>Imagem</th>
                        <th>Produto</th>
                        <th>Valor Unitário</th>
                        <th>Quantidade</th>
                        <th>Subtotal</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody id="cart-items"></tbody>
            </table>
            <div class="cart-total" id="cart-total">Total: R$ 0.00</div>
            <div class="cart-actions">
                <button onclick="sendOrderToWhatsApp()">Enviar Pedido para WhatsApp (27) 98138-2565</button>
                <p>Você pode solicitar o pagamento por **PIX**, receber um <a href="#" target="_blank">Link de pagamento</a> ou negociar pelo WhatsApp.</p>
            </div>
        </div>
    </section>

    <section id="admin" class="section" style="display: none;">
        <div class="admin-panel">
            <h2>Painel Administrativo</h2>
            <div id="login-form">
                <label for="admin-password">Senha de Admin:</label>
                <input type="password" id="admin-password">
                <button onclick="loginAdmin()">Login</button>
            </div>
            <div id="admin-content" class="hidden">
                <h3>Adicionar/Editar Produto</h3>
                <label for="product-id">ID (Único):</label>
                <input type="text" id="product-id">
                <label for="product-name">Nome:</label>
                <input type="text" id="product-name">
                <label for="product-category">Categoria:</label>
                <input type="text" id="product-category">
                <label for="product-description">Descrição:</label>
                <textarea id="product-description"></textarea>
                <label for="product-value">Valor:</label>
                <input type="number" id="product-value" step="0.01">
                <label for="product-image-url">URL da Imagem:</label>
                <input type="text" id="product-image-url">
                <button onclick="saveProduct()">Salvar Produto</button>
                <button onclick="clearProductForm()">Limpar Formulário</button>

                <h3>Gerenciar Produtos</h3>
                <input type="file" id="excel-file" accept=".xlsx, .xls">
                <button onclick="loadProductsFromExcel()">Carregar Produtos do Excel</button>
                <button onclick="saveProductsAsExcel()">Salvar Produtos como Excel</button>
                <button onclick="deleteAllProducts()" class="delete">Deletar Todos os Produtos</button>
                
                <p><strong>Observação:</strong> Alterações manuais são salvas no navegador. Para salvar permanentemente, clique em "Salvar Produtos como Excel" e depois em "Salvar HTML Atualizado" para baixar a versão mais recente do site.</p>
                <button onclick="saveCurrentHtml()">Salvar HTML Atualizado</button>

                <h3>Lista de Produtos Salvos</h3>
                <ul id="product-list-admin">
                    </ul>
            </div>
        </div>
    </section>

    <div id="image-modal" class="image-modal" onclick="closeImageModal()">
        <span class="close-modal">&times;</span>
        <img class="modal-content" id="modal-image">
    </div>

    <script>
        let produtosSalvos = [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const adminPassword = "admin"; // Senha de admin

        function salvarProdutos() {
            localStorage.setItem('produtosSalvos', JSON.stringify(produtosSalvos));
            carregarProdutosSalvos(); // Recarrega a lista de produtos na tela principal e no admin
        }

        function carregarProdutosSalvos() {
            const storedProducts = localStorage.getItem('produtosSalvos');
            if (storedProducts) {
                produtosSalvos = JSON.parse(storedProducts);
            } else {
                // Produtos de exemplo se não houver nada salvo
                produtosSalvos = [
                    { id: '1', nome: 'Produto A', categoria: 'Categoria 1', descricao: 'Descrição do Produto A', valor: 10.50, imagem: 'https://via.placeholder.com/150' },
                    { id: '2', nome: 'Produto B', categoria: 'Categoria 2', descricao: 'Descrição do Produto B', valor: 20.00, imagem: 'https://via.placeholder.com/150' }
                ];
                salvarProdutos(); // Salva os produtos de exemplo para iniciar
            }
            renderProducts();
            renderAdminProductList();
            renderCategoryFilters();
        }

        function renderProducts(filteredProducts = produtosSalvos) {
            const productGrid = document.getElementById('product-grid');
            if (!productGrid) return; // Garante que o elemento existe

            productGrid.innerHTML = '';
            filteredProducts.forEach(p => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <img src="${p.imagem || 'https://via.placeholder.com/150'}" alt="${p.nome}" class="product-thumbnail" onclick="openImageModal('${p.imagem || 'https://via.placeholder.com/600'}', '${p.nome}')">
                    <h3>${p.nome}</h3>
                    <p>${p.descricao}</p>
                    <p class="price">R$ ${parseFloat(p.valor).toFixed(2).replace('.', ',')}</p>
                    <button onclick="addToCart('${p.id}')">Adicionar ao Carrinho</button>
                `;
                productGrid.appendChild(productCard);
            });
        }

        function renderCategoryFilters() {
            const categoryFilters = document.getElementById('category-filters');
            if (!categoryFilters) return;

            categoryFilters.innerHTML = '<button onclick="filterProducts(\'all\')" class="active">Todas</button>';
            const categories = [...new Set(produtosSalvos.map(p => p.categoria))];
            categories.forEach(category => {
                const button = document.createElement('button');
                button.textContent = category;
                button.onclick = () => filterProducts(category);
                categoryFilters.appendChild(button);
            });
        }

        function filterProducts(category) {
            const buttons = document.querySelectorAll('#category-filters button');
            buttons.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`#category-filters button[onclick="filterProducts('${category}')"]`).classList.add('active');

            let filtered = produtosSalvos;
            if (category !== 'all') {
                filtered = produtosSalvos.filter(p => p.categoria === category);
            }
            renderProducts(filtered);
        }

        document.getElementById('search-input').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filtered = produtosSalvos.filter(p => 
                p.nome.toLowerCase().includes(searchTerm) ||
                p.descricao.toLowerCase().includes(searchTerm) ||
                p.categoria.toLowerCase().includes(searchTerm)
            );
            renderProducts(filtered);
        });

        function mostrarPainel(panelId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(panelId).classList.add('active');

            if (panelId === 'admin') {
                checkAdminLogin();
            } else if (panelId === 'carrinho') {
                renderCart(); // Garante que o carrinho é renderizado ao ser mostrado
            }
        }

        // Funções do Carrinho
        function addToCart(productId) {
            const product = produtosSalvos.find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantidade++;
                } else {
                    cart.push({ ...product, quantidade: 1 });
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                renderCart(); // Atualiza a exibição do carrinho
                alert(`${product.nome} adicionado ao carrinho!`);
            } else {
                console.error('Produto não encontrado:', productId);
                alert('Produto não encontrado. Verifique o ID.');
            }
        }

        function updateQuantity(productId, newQuantity) {
            const item = cart.find(i => i.id === productId);
            if (item) {
                item.quantidade = parseInt(newQuantity);
                if (item.quantidade <= 0) {
                    removeFromCart(productId);
                } else {
                    localStorage.setItem('cart', JSON.stringify(cart));
                    renderCart();
                }
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
        }

        // INÍCIO DA ALTERAÇÃO PARA FUNÇÃO RENDER CART CORRIGIDA
        function renderCart() {
            const cartItemsElement = document.getElementById('cart-items');
            const cartTotalElement = document.getElementById('cart-total');
            const observacoesTextArea = document.getElementById('observacoes-adicionais');

            let total = 0;

            // Limpa o conteúdo atual do carrinho
            if (cartItemsElement) { // Garante que o elemento existe antes de limpar
                cartItemsElement.innerHTML = '';
            }

            cart.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><img src="${item.imagem}" alt="${item.nome}" style="width: 50px; height: 50px; object-fit: cover;"></td>
                    <td>${item.nome}</td>
                    <td>R$ ${parseFloat(item.valor).toFixed(2).replace('.', ',')}</td>
                    <td>
                        <input type="number" value="${item.quantidade}" min="1" onchange="updateQuantity('${item.id}', this.value)" style="width: 50px;">
                    </td>
                    <td>R$ ${(item.quantidade * parseFloat(item.valor)).toFixed(2).replace('.', ',')}</td>
                    <td>
                        <button onclick="removeFromCart('${item.id}')" style="background-color: #dc3545; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 3px;">Remover</button>
                    </td>
                `;
                if (cartItemsElement) { // Garante que o elemento existe antes de adicionar a linha
                    cartItemsElement.appendChild(row);
                }
                total += item.quantidade * parseFloat(item.valor);
            });

            // Atualiza o total do carrinho
            if (cartTotalElement) { // Garante que o elemento existe antes de atualizar o texto
                cartTotalElement.textContent = `Total: R$ ${total.toFixed(2).replace('.', ',')}`;
            }

            // Carrega e salva as observações adicionais
            if (observacoesTextArea) { // Garante que o elemento existe antes de acessar .value ou .oninput
                const observacoesSalvas = localStorage.getItem('observacoes-adicionais');
                if (observacoesSalvas) {
                    observacoesTextArea.value = observacoesSalvas;
                }
                // Adiciona um listener para salvar as observações quando mudam
                observacoesTextArea.oninput = function() {
                    localStorage.setItem('observacoes-adicionais', this.value);
                };
            }
        }
        // FIM DA ALTERAÇÃO PARA FUNÇÃO RENDER CART CORRIGIDA


        function sendOrderToWhatsApp() {
            if (cart.length === 0) {
                alert("Seu carrinho está vazio. Adicione produtos antes de enviar o pedido.");
                return;
            }

            let orderDetails = "Olá! Gostaria de fazer o seguinte pedido:\n\n";
            let total = 0;

            cart.forEach(item => {
                orderDetails += `- ${item.nome} (x${item.quantidade}) - R$ ${parseFloat(item.valor).toFixed(2).replace('.', ',')} cada = R$ ${(item.quantidade * parseFloat(item.valor)).toFixed(2).replace('.', ',')}\n`;
                total += item.quantidade * parseFloat(item.valor);
            });

            orderDetails += `\nTotal do Pedido: R$ ${total.toFixed(2).replace('.', ',')}\n`;

            const observacoes = document.getElementById('observacoes-adicionais').value;
            if (observacoes) {
                orderDetails += `\nObservações: ${observacoes}\n`;
            }

            orderDetails += "\nPor favor, aguardo o seu retorno para combinar o pagamento e a entrega.";

            const phoneNumber = "5527981382565"; // Número com código do país (55) e DDD (27)
            const whatsappUrl = `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${encodeURIComponent(orderDetails)}`;

            window.open(whatsappUrl, '_blank');
        }

        // Funções de Admin
        function checkAdminLogin() {
            const adminLoggedIn = localStorage.getItem('isAdminLoggedIn');
            if (adminLoggedIn === 'true') {
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('admin-content').classList.remove('hidden');
                renderAdminProductList();
            } else {
                document.getElementById('login-form').classList.remove('hidden');
                document.getElementById('admin-content').classList.add('hidden');
            }
        }

        function loginAdmin() {
            const passwordInput = document.getElementById('admin-password');
            if (passwordInput.value === adminPassword) {
                localStorage.setItem('isAdminLoggedIn', 'true');
                checkAdminLogin();
            } else {
                alert('Senha incorreta!');
                passwordInput.value = '';
            }
        }

        function saveProduct() {
            const id = document.getElementById('product-id').value;
            const nome = document.getElementById('product-name').value;
            const categoria = document.getElementById('product-category').value;
            const descricao = document.getElementById('product-description').value;
            const valor = parseFloat(document.getElementById('product-value').value);
            const imagem = document.getElementById('product-image-url').value;

            if (!id || !nome || !categoria || isNaN(valor)) {
                alert('Por favor, preencha todos os campos obrigatórios (ID, Nome, Categoria, Valor).');
                return;
            }

            const existingIndex = produtosSalvos.findIndex(p => p.id === id);
            if (existingIndex > -1) {
                produtosSalvos[existingIndex] = { id, nome, categoria, descricao, valor, imagem };
                alert('Produto atualizado com sucesso!');
            } else {
                produtosSalvos.push({ id, nome, categoria, descricao, valor, imagem });
                alert('Produto adicionado com sucesso!');
            }
            salvarProdutos();
            clearProductForm();
        }

        function clearProductForm() {
            document.getElementById('product-id').value = '';
            document.getElementById('product-name').value = '';
            document.getElementById('product-category').value = '';
            document.getElementById('product-description').value = '';
            document.getElementById('product-value').value = '';
            document.getElementById('product-image-url').value = '';
        }

        function renderAdminProductList() {
            const productListAdmin = document.getElementById('product-list-admin');
            if (!productListAdmin) return;
            productListAdmin.innerHTML = '';
            produtosSalvos.forEach(p => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span>${p.nome} (ID: ${p.id})</span>
                    <div>
                        <button onclick="editProduct('${p.id}')">Editar</button>
                        <button onclick="deleteProduct('${p.id}')" class="delete">Excluir</button>
                    </div>
                `;
                productListAdmin.appendChild(li);
            });
        }

        function editProduct(productId) {
            const product = produtosSalvos.find(p => p.id === productId);
            if (product) {
                document.getElementById('product-id').value = product.id;
                document.getElementById('product-name').value = product.nome;
                document.getElementById('product-category').value = product.categoria;
                document.getElementById('product-description').value = product.descricao;
                document.getElementById('product-value').value = product.valor;
                document.getElementById('product-image-url').value = product.imagem;
            }
        }

        function deleteProduct(productId) {
            if (confirm('Tem certeza que deseja excluir este produto?')) {
                produtosSalvos = produtosSalvos.filter(p => p.id !== productId);
                salvarProdutos();
                renderAdminProductList();
                alert('Produto excluído com sucesso!');
            }
        }

        function loadProductsFromExcel() {
            const fileInput = document.getElementById('excel-file');
            const file = fileInput.files[0];
            if (!file) {
                alert('Por favor, selecione um arquivo Excel.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                const json = XLSX.utils.sheet_to_json(worksheet);

                // Mapear as colunas do Excel para as propriedades do produto
                // Certifique-se que os nomes das colunas no seu Excel batem com estes nomes
                // ou ajuste os nomes aqui
                const newProducts = json.map(row => ({
                    id: String(row['ID'] || '').trim(), // Garante que o ID é string e sem espaços
                    nome: String(row['Nome'] || '').trim(),
                    categoria: String(row['Categoria'] || '').trim(),
                    descricao: String(row['Descrição'] || '').trim(),
                    valor: parseFloat(String(row['Valor'] || '0').replace(',', '.')), // Lida com vírgula para decimal
                    imagem: String(row['Imagem'] || '').trim() // URL da imagem
                }));

                // Adiciona ou sobrescreve produtos
                newProducts.forEach(newProduct => {
                    const existingIndex = produtosSalvos.findIndex(p => p.id === newProduct.id);
                    if (existingIndex > -1) {
                        produtosSalvos[existingIndex] = newProduct; // Atualiza
                    } else {
                        produtosSalvos.push(newProduct); // Adiciona
                    }
                });

                salvarProdutos();
                alert('Produtos carregados do Excel com sucesso!');
            };
            reader.readAsArrayBuffer(file);
        }

        function saveProductsAsExcel() {
            const data = produtosSalvos.map(p => ({
                ID: p.id,
                Nome: p.nome,
                Categoria: p.categoria,
                Descrição: p.descricao,
                Valor: p.valor,
                Imagem: p.imagem
            }));

            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Produtos");
            XLSX.writeFile(workbook, "produtos_catalogo.xlsx");
            alert("Produtos salvos como 'produtos_catalogo.xlsx'.");
        }

        function deleteAllProducts() {
            if (confirm("Tem certeza que deseja deletar todos os produtos? Esta ação é irreversível!")) {
                produtosSalvos = [];
                salvarProdutos();
                carregarProdutosSalvos();
                alert("Todos os produtos foram deletados.");
            }
        }

        function saveCurrentHtml() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'index.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert("O arquivo HTML foi salvo como 'index.html'.");
        }

        function openImageModal(imageUrl, altText) {
            const imageModal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            if (imageModal && modalImage) { // Garante que os elementos existem
                modalImage.src = imageUrl;
                modalImage.alt = altText;
                imageModal.style.display = 'flex';
            }
        }

        function closeImageModal() {
            const imageModal = document.getElementById('image-modal');
            if (imageModal) { // Garante que o elemento existe
                imageModal.style.display = 'none';
            }
        }

        window.onload = function() {
            localStorage.removeItem('isAdminLoggedIn');
            carregarProdutosSalvos();
            mostrarPainel('produtos');
            renderCart(); // Garante que o carrinho é renderizado ao carregar a página
        };
    </script>
</body>
</html>